# 视频匹配功能改进计划

## 目标
修改"开始配视频"按钮的功能逻辑，从单个视频匹配改为10个候选视频的展示和选择。

## 具体修改步骤

### 1. 后端函数修改 (`src/agent_v5.py`)
- **修改 `match_video` 函数**：将 `n_results=1` 改为 `n_results=10`，使其返回10个候选视频
- **添加新函数 `match_multiple_videos`**：专门处理多个视频匹配结果，返回视频列表和相关信息

### 2. UI布局重构 (`v5.py`)
- **移除现有的单个视频播放器**：删除 `tts_video_player`
- **添加10个候选视频区域**：
  - 创建 `candidate_videos_container` 容器
  - 添加10个 `gr.Video` 组件 (`candidate_video_1` 到 `candidate_video_10`)
  - 为每个视频播放器下方添加 `gr.Button` 组件 (`select_video_1` 到 `select_video_10`)

### 3. 事件处理逻辑
- **修改 `match_video_for_selection` 函数**：处理10个视频的展示
- **为每个选择按钮添加事件处理**：点击时更新格式化结果和主视频播放器
- **保持现有的背景视频播放器**：用于显示选中的视频

### 4. 数据流修改
- **更新 `output_text` 格式**：为每个句子记录选中的视频路径
- **选择逻辑**：点击选择按钮后更新对应句子的 `video_path` 字段

## 界面布局预期效果
```
开始配视频
┌─────────────────────────────────────┐
│ 候选视频1                    [选择这个视频] │
│ ┌─────────────────────────────────┐ │
│ │        视频播放器1               │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 候选视频2                    [选择这个视频] │
│ ┌─────────────────────────────────┐ │
│ │        视频播放器2               │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ... (共10个)                       │
│                                     │
│ 候选视频10                   [选择这个视频] │
│ ┌─────────────────────────────────┐ │
│ │        视频播放器10              │ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

## 技术细节
- 保持现有的JSON数据格式兼容性
- 确保选择按钮的样式为等宽按钮
- 实现错误处理和用户反馈机制

请确认这个计划是否符合您的需求，或者您希望调整哪些部分？